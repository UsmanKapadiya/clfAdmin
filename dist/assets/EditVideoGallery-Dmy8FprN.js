import{b as T,u as w,r as i,y as h,j as e}from"./index-BkylyDC8.js";import{D as U}from"./DashboardLayout-CUVQyk-J.js";import{V}from"./VideoLibrary-KcSjoIla.js";import{f as C,h as q,i as F}from"./galleryApi-CGkPiNuK.js";import"./logo-DBYIBsYi.js";const P=()=>{const{id:m}=T(),d=w(),t=m==="new",[p,c]=i.useState(!1),[b,s]=i.useState(""),[f,x]=i.useState(""),[a,g]=i.useState({id:"",title:"",catalogThumbnail:"",videoUrl:""});i.useEffect(()=>{t||(c(!0),s(""),C(m).then(l=>{var r;if(l.success&&l.data){const o=((r=l.data)==null?void 0:r.data)||l.data;g({id:o._id,title:o.title,catalogThumbnail:o.catalogThumbnail,videoUrl:o.videoUrl})}else s(l.error||"Video not found")}).catch(()=>s("Video not found")).finally(()=>c(!1)))},[m,t]);const n=i.useCallback(()=>{s(""),x("")},[]),u=i.useCallback(l=>{const{name:r,value:o}=l.target;g(N=>({...N,[r]:o})),n()},[n]),v=i.useCallback(()=>a.title.trim()?a.catalogThumbnail.trim()?a.videoUrl.trim()?!0:(s("YouTube embed URL is required"),!1):(s("Thumbnail URL is required"),!1):(s("Title is required"),!1),[a]),y=i.useCallback(async l=>{if(l.preventDefault(),!!v()){c(!0),n();try{let r;t?r=await q(a):r=await F(a.id,a),r.success?(h.success("Video gallery saved successfully!"),d("/gallery")):(s(r.error||"Failed to save video gallery. Please try again."),h.error(r.error||"Failed to save video gallery. Please try again."))}catch{s("Failed to save video gallery. Please try again."),h.error("Failed to save video gallery. Please try again.")}finally{c(!1)}}},[a,v,n,t,d]),j=i.useCallback(()=>{d("/gallery")},[d]);return e.jsx(U,{children:e.jsx("div",{className:"edit-gallery-page",children:e.jsxs("div",{className:"edit-form-card",children:[e.jsxs("div",{className:"edit-form-header",children:[e.jsx("h1",{className:"edit-form-title",children:t?"Add Video Gallery":"Edit Video Gallery"}),e.jsx("p",{className:"edit-form-subtitle",children:t?"Create a new video gallery":`Editing: ${a.title||"Loading..."}`})]}),b&&e.jsx("div",{className:"error-banner",children:b}),f&&e.jsx("div",{className:"success-banner",children:f}),e.jsxs("form",{onSubmit:y,className:"edit-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title",className:"form-label form-label-required",children:"Video Title"}),e.jsx("input",{type:"text",id:"title",name:"title",className:"form-input",placeholder:"e.g., React Tutorial",value:a.title,onChange:u,required:!0}),e.jsx("p",{className:"form-help-text",children:"Main title of the video"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"catalogThumbnail",className:"form-label form-label-required",children:"Thumbnail URL"}),e.jsx("input",{type:"url",id:"catalogThumbnail",name:"catalogThumbnail",className:"form-input",placeholder:"https://img.youtube.com/vi/xxxx/hqdefault.jpg",value:a.catalogThumbnail,onChange:u,required:!0}),e.jsx("p",{className:"form-help-text",children:"Main thumbnail for video card"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"videoUrl",className:"form-label form-label-required",children:"YouTube Embed URL"}),e.jsx("input",{type:"url",id:"videoUrl",name:"videoUrl",className:"form-input",placeholder:"https://www.youtube.com/embed/xxxx",value:a.videoUrl,onChange:u,required:!0}),e.jsx("p",{className:"form-help-text",children:"Paste the YouTube embed URL (not the share link)"})]})}),a.catalogThumbnail&&e.jsxs("div",{className:"thumbnail-preview",children:[e.jsx("label",{className:"form-label",children:"Thumbnail Preview:"}),e.jsx("img",{src:a.catalogThumbnail,alt:"Thumbnail preview",onError:l=>l.target.style.display="none",onLoad:l=>l.target.style.display="block"})]}),a.videoUrl&&e.jsxs("div",{className:"video-preview",children:[e.jsx("label",{className:"form-label",children:"Video Preview:"}),e.jsx("iframe",{width:"100%",height:"315",src:a.videoUrl,title:"Video preview",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,style:{borderRadius:8,marginTop:8}})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"submit",className:"btn-add",disabled:p,children:[e.jsx(V,{style:{marginRight:6}}),t?"Add Video":"Save Changes"]}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:j,children:"Cancel"})]})]})]})})})};export{P as default};
