import{j as t,u as $,r as l,y as g}from"./index-BkylyDC8.js";import{d as u,r as L}from"./relativeTime-DTi7sQsR.js";import{c as O,D as _}from"./DashboardLayout-CUVQyk-J.js";import{A as T,G as z,C as F,E as H}from"./GlobalLoader-DTVyf5T6.js";import{deleteAbout as M,getAboutList as N}from"./aboutApi-8cmP2KYY.js";import{D as U}from"./Delete-BoIrEoUI.js";import"./logo-DBYIBsYi.js";const B=O(t.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}));u.extend(L);const Q=()=>{const m=$(),[c,h]=l.useState("all"),[v,C]=l.useState([]),[o,r]=l.useState({isOpen:!1,itemId:null,itemName:""}),[n,x]=l.useState([]),[I,d]=l.useState(!0),[p,b]=l.useState(null);l.useEffect(()=>{(async()=>{var a;d(!0),b(null);const s=await N();s.success?x((a=s.data)==null?void 0:a.data):b(s.error||"Failed to fetch about list")})(),d(!1)},[]);const y=l.useMemo(()=>Array.from(new Set(n.map(e=>e.category))).filter(Boolean),[n]),f=l.useMemo(()=>c==="all"?n:n.filter(e=>e.category===c),[c,n]),A=l.useCallback(e=>{C(s=>s.includes(e)?s.filter(a=>a!==e):[...s,e])},[]),D=l.useCallback((e,s)=>{s.stopPropagation(),m(`/about/edit/${e}`)},[m]),k=l.useCallback((e,s)=>{s.stopPropagation();const a=n.find(i=>i.id===e);r({isOpen:!0,itemId:e,itemName:(a==null?void 0:a.name)||"this item"})},[n]),E=l.useCallback(async()=>{var s;if(!o.itemId)return;d(!0);const e=await M(o.itemId);if(e.success){const a=await N();a.success&&x((s=a.data)==null?void 0:s.data),g.success("Item deleted successfully!"),r({isOpen:!1,itemId:null,itemName:""})}else g.error(e.error||e.message||"Failed to delete item"),r({isOpen:!1,itemId:null,itemName:""});d(!1)},[o.itemId]),S=l.useCallback(()=>{r({isOpen:!1,itemId:null,itemName:""})},[]),w=l.useCallback(e=>e?e.toUpperCase():"",[]);function j(e,s=!1){const a=v.includes(e._id);return t.jsx(t.Fragment,{children:t.jsxs("div",{children:[t.jsxs("div",{className:`about-item ${s?"child":"parent"}`,onClick:()=>A(e._id),children:[t.jsxs("div",{className:"about-item-header",children:[t.jsxs("div",{className:"about-item-info",children:[t.jsx("div",{className:"about-item-name",children:e.name}),t.jsx("div",{className:"about-item-title",children:e.title}),t.jsxs("div",{className:"about-item-badges",children:[t.jsx("span",{className:"badge",children:w(e.category)}),t.jsx("span",{className:"badge",children:e.updatedAt?`Updated ${u(e.updatedAt).fromNow()}`:e.createdAt?`Created ${u(e.createdAt).fromNow()}`:""})]})]}),t.jsxs("div",{className:"about-item-actions",children:[t.jsx("button",{className:"btn-icon edit",onClick:i=>D(e._id,i),title:"Edit","aria-label":`Edit ${e.name}`,children:t.jsx(H,{})}),t.jsx("button",{className:"btn-icon delete",onClick:i=>k(e._id,i),title:"Delete","aria-label":`Delete ${e.name}`,children:t.jsx(U,{})})]})]}),a&&t.jsx("div",{className:"about-item-description",children:t.jsx("div",{dangerouslySetInnerHTML:{__html:e.description}})})]}),e.children&&e.children.length>0&&t.jsx("div",{style:{marginTop:"8px"},children:e.children.map(i=>j(i,!0))})]},e._id)})}return t.jsx(t.Fragment,{children:t.jsx(_,{children:t.jsxs("div",{className:"about-page",children:[t.jsx("div",{className:"page-header",children:t.jsxs("div",{className:"about-header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"page-title",children:"About Content"}),t.jsx("p",{className:"page-subtitle",children:"Manage martial arts and instructor information"})]}),t.jsx("div",{className:"about-actions",children:t.jsxs("button",{className:"btn-add",onClick:()=>m("/about/edit/new"),children:[t.jsx(T,{}),"Add New Item"]})})]})}),t.jsxs("div",{className:"filter-tabs",children:[t.jsxs("button",{className:`filter-tab ${c==="all"?"active":""}`,onClick:()=>h("all"),children:["All (",n.length,")"]}),y.map(e=>{const s=n.filter(a=>a.category===e).length;return t.jsxs("button",{className:`filter-tab ${c===e?"active":""}`,onClick:()=>h(e),children:[e.charAt(0).toUpperCase()+e.slice(1)," (",s,")"]},e)})]}),t.jsxs("div",{className:"about-list",children:[I&&t.jsx(z,{text:"Loading..."}),p?t.jsx("div",{className:"empty-state",children:p}):f.length>0?t.jsx(t.Fragment,{children:f.map(e=>j(e))}):t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state-icon",children:t.jsx(B,{style:{fontSize:48}})}),t.jsx("div",{className:"empty-state-text",children:"No items found"})]})]}),t.jsx(F,{isOpen:o.isOpen,onClose:S,onConfirm:E,title:"Delete Item",message:`Are you sure you want to delete "${o.itemName}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",type:"danger"})]})})})};export{Q as default};
